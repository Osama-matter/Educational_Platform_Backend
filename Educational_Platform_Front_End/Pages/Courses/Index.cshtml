@page
@model Educational_Platform_Front_End.Pages.Courses.IndexModel
@{
    ViewData["Title"] = "All Courses";
}

<div class="container pt-8 pb-8">
    <header class="flex justify-between items-center mb-8">
        <div>
            <h1 class="heading-2 mb-2">Course Catalog</h1>
            <p class="text-muted">Discover courses to advance your career and skills</p>
        </div>
        <a asp-page="/Courses/Create" class="btn btn--primary">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <line x1="10" y1="4" x2="10" y2="16" />
                <line x1="4" y1="10" x2="16" y2="10" />
            </svg>
            Create Course
        </a>
    </header>

    <div class="flex justify-between items-center mb-6">
        <div class="search-bar" style="flex: 1;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <circle cx="11" cy="11" r="7" />
                <path d="M21 21l-4.3-4.3" />
            </svg>
            <input type="text" placeholder="Search by skill, role, or outcome" aria-label="Search courses" />
        </div>
        <div class="flex items-center gap-4">
            <span class="filter-chip">120+ results</span>
            <div class="view-toggle" role="group" aria-label="Toggle view">
                <button type="button" class="is-active" data-view="grid">Grid</button>
                <button type="button" data-view="list">List</button>
            </div>
        </div>
    </div>

    <div class="catalog">
        <aside class="filter-panel" aria-label="Course filters">
            <h3 class="heading-5 mb-4">Filter courses</h3>
            <div class="filter-panel__group">
                <p class="text-small text-muted mb-2">Category</p>
                <div class="flex flex-col gap-2">
                    <label class="form__checkbox"><input type="checkbox" checked /> Product</label>
                    <label class="form__checkbox"><input type="checkbox" /> Data</label>
                    <label class="form__checkbox"><input type="checkbox" /> Engineering</label>
                    <label class="form__checkbox"><input type="checkbox" /> Design</label>
                </div>
            </div>
            <div class="filter-panel__group">
                <p class="text-small text-muted mb-2">Level</p>
                <div class="flex flex-col gap-2">
                    <label class="form__checkbox"><input type="checkbox" checked /> Beginner</label>
                    <label class="form__checkbox"><input type="checkbox" checked /> Intermediate</label>
                    <label class="form__checkbox"><input type="checkbox" /> Advanced</label>
                </div>
            </div>
            <div class="filter-panel__group">
                <p class="text-small text-muted mb-2">Duration</p>
                <div class="flex flex-col gap-2">
                    <label class="form__checkbox"><input type="checkbox" /> Under 4 hours</label>
                    <label class="form__checkbox"><input type="checkbox" checked /> 4-10 hours</label>
                    <label class="form__checkbox"><input type="checkbox" /> 10+ hours</label>
                </div>
            </div>
            <button class="btn btn--secondary btn--full" type="button">Reset filters</button>
        </aside>

        <section>
            @if (Model.Courses != null && Model.Courses.Any())
            {
                <div class="course-list" data-view="grid">
                    @foreach (var course in Model.Courses)
                    {
                        <article class="card">
                            <img src="@course.Image_URl"
                                 alt="@course.Title course thumbnail"
                                 class="card__image"
                                 loading="lazy" />
                            <div class="card__body">
                                <h2 class="card__title">@course.Title</h2>
                                <p class="text-small text-muted mb-4">
                                    @if (course.Description?.Length > 120)
                                    {
                                        @course.Description.Substring(0, 120)
                                    }
                                    else
                                    {
                                        @course.Description
                                    }
                                </p>
                                <div class="flex items-center gap-4 mb-4">
                                    @if (course.EstimatedDurationHours.HasValue)
                                    {
                                        <span class="badge badge--neutral">
                                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                                                <circle cx="7" cy="7" r="6" />
                                                <path d="M7 3.5V7H10.5" />
                                            </svg>
                                            @course.EstimatedDurationHours hours
                                        </span>
                                    }

                                    @if (course.IsActive)
                                    {
                                        <span class="badge badge--success">Active</span>
                                    }
                                    else
                                    {
                                        <span class="badge badge--neutral">Inactive</span>
                                    }
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="badge badge--primary">Career track</span>
                                    <span class="badge badge--neutral">Certificate</span>
                                </div>
                            </div>
                            <div class="card__footer">
                                <a asp-page="/Courses/Details" asp-route-id="@course.Id" class="btn btn--primary btn--full">
                                    View Course
                                </a>
                            </div>
                        </article>
                    }
                </div>
            }
            else
            {
                <div class="card">
                    <div class="card__body text-center" style="padding: var(--spacing-16);">
                        <svg width="64" height="64" viewBox="0 0 64 64" fill="none" stroke="var(--color-neutral-400)" stroke-width="2" style="margin: 0 auto var(--spacing-6);">
                            <rect x="8" y="12" width="48" height="40" rx="4" />
                            <line x1="8" y1="22" x2="56" y2="22" />
                            <circle cx="32" cy="37" r="8" />
                        </svg>
                        <h2 class="heading-4 mb-2">No Courses Available</h2>
                        <p class="text-muted mb-6">There are no courses in the catalog yet. Check back soon!</p>
                        <a asp-page="/Courses/Create" class="btn btn--primary">Create First Course</a>
                    </div>
                </div>
            }
        </section>
    </div>
</div>

@section Scripts {
    <script>
        const viewToggle = document.querySelectorAll('.view-toggle button');
        const courseList = document.querySelector('.course-list');

        viewToggle.forEach(button => {
            button.addEventListener('click', () => {
                viewToggle.forEach(btn => btn.classList.remove('is-active'));
                button.classList.add('is-active');
                if (!courseList) return;
                const view = button.dataset.view;
                courseList.classList.toggle('course-list--row', view === 'list');
            });
        });
    </script>
}